# CURRENT TASK
User query: $query
Previous actions: [$thread]

# YOUR JOB
Analyze the previous actions to determine what's already done, then choose the next action.

Available actions: $actions_short

# OUTPUT FORMAT
IMPORTANT: Output ONLY the JSON object below. No extra text, explanations, or markdown formatting.

{
  "chain_of_thought": "What's already done? What's next needed?",
  "action": "ActionName", 
  "arguments": {"key": "value"}
}

# KEY RULES
1. **Check thread first** - If calculation is complete, use Done
2. **Follow math order** - multiplication/division before addition/subtraction  
3. **Ask for unknowns** - If you see letters (x, y, a, etc.) use AskUser first
4. **One step only** - Do not calculate in your head, use tools

# EXAMPLES
$examples

Remember: Output ONLY the JSON object. No markdown, no explanations, no extra text.